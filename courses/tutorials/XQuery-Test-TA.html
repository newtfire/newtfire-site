
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml">
   
   	
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <link rel="stylesheet" type="text/css" href="explain.css" />
      <title>XQuery Exercise Test (TA)</title>
   </head>
   
   
   
   <body>
      <!--#include virtual="top.html" -->
      	
      		
      <h1><span class="banner">XQuery Test (Text Analysis)</span></h1>
     <p>The Star Wars project team has prepared an XML corpus of five distinct drafts of the first Star Wars movie, <i>A New Hope</i>. For this test, we are interested in looking at speeches (coded as <code>&lt;sp&gt;</code> elements) and speakers (coded as <code>@spk</code> attributes on those elements). You should review the code by viewing it in the database or in oXygen to be sure you understand how it is structured. The Star Wars collection is stored on the <a href="http://exist.newtfire.org/exist/apps/eXide/index.html">the newtFire eXist-dB server</a>. and you may access it with a variable pointing to the collection at: </p>
       <pre>collection('/db/starwars/fixed/')</pre>  

<p>Write an XQuery script does the following: (Remember to save your work as you go using the <code>.xql</code> extension for XQuery. You may use your personal folder on the newtfire eXist-dB. As needed, add XQuery comments in your file.</p>
 
 <h2>Part 1: Write a FLWOR and return a concatenated string</h2>
 <ol>
   <li>Begin by creating a variable called <code>$drafts</code> that points to the collection at <code>collection('/db/starwars/fixed/')</code>. Make sure your varialble returns the five Star Wars drafts before continuing. (1 point)</li>
   <li>Copy in this variable and answer a question about it in your file by writing an XQuery comment : 
       <pre>
         let $sortOrder := 
            for $d in $drafts
            let $date := $d//date/@date ! data()
            order by $date
            return $d</pre>
      Return this variable and inspect your results. Notice what information is stored in the date attribute near the top of each file. 
      In an XQuery comment, explain in your own words what is happening inside the <code>$sortOrder</code> variable and what it does to the sequence of files in the collection. (3 points)
   </li>
   <li>Write a <code>for loop</code> that looks in each member of the sequence stored in the <code>$sortOrder</code> variable, and also stores the position number of each turn of the for loop. (3 points) </li>
   <li>Write two variables to retrieve the date and the title of each draft in this loop. (3 points)</li>
   <li>Write a variable that counts all speeches in each draft in this loop. (2 points)</li>
   <li>Now, we want to find out the distinct speakers in each section: Write a variable that finds the speakers, removes any extra spaces from the nodes, and eliminates repeated values. (4 points)</li>
   <li>Retrieve a count of those distinct speakers. (2 points)</li>
     <li>We want our return to help us compare the count of distinct speakers with the count of all speeches in each draft. Make your first version of this return statement a concatenated line of text, outputting the position in the <code>for loop</code>, the draft title, the draft date, the count of speeches, and the count of distinct speakers, using text separators of your choice. (4 points)</li>
     <li>To continue to the next part of the test, comment out the previous return (do not delete it, so I can give you credit for it on this exam.) (1 point).<p>Part I of this exam is worth a total possible 23 points. If you have completed this much, you have finished 77% of the exam.</p></li> 
 </ol>
   

   <h2>Part 2: HTML or SVG: Your Choice</h2>    
<p>To complete the remaining 20% of the exam, build an HTML or an SVG file around your FLWOR, and make your FLWOR output the variables above in well-formed and tastefully repeating elements. Create your choice of either an HTML table or an SVG bar graph, showing the two counts side by side at each position mark from the <code>for loop</code>. You may save your output to your individual folder on the newtfire eXist if you wish. (7 points)</p>

<h2>Submitting your test</h2>      
       
       <p>Please submit your XQuery file on Canvas at the submission point for this exam. Download your XQuery file from the newtfire eXist-dB into a file saved with the <code>.xql</code> file extension. You may also submit your output SVG or HTML file as a link to its REST address from the newtfire eXist-dB server. Or download and save these to submit on Canvas. You must at least submit your XQuery <code>.xql</code> file to complete this exam. <strong>Bonus:</strong> One extra credit point is available if you send a functioning REST address to your output from the eXist-dB database. 
         </p>

  
   </body>
   
</html>